from base64 import b64decode as dec
exec(dec('ZnJvbSBvcyBpbXBvcnQgc3lzdGVtLCBsaXN0ZGlyCmZyb20gdGltZSBpbXBvcnQgc2xlZXAKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQgYXMgcm50CnN5c3RlbSgncGlwIGluc3RhbGwgc2VsZW5pdW09PTMuMTQxIHNlbGVuaXVtLXV0aWxpdGllcyByZXF1ZXN0cyB1Z2VudHMnKQpmcm9tIHNlbGVuaXVtIGltcG9ydCB3ZWJkcml2ZXIKZnJvbSBzZWxlbml1bS53ZWJkcml2ZXIuY29tbW9uLmFjdGlvbl9jaGFpbnMgaW1wb3J0IEFjdGlvbkNoYWlucwpmcm9tIHNlbGVuaXVtLndlYmRyaXZlci5zdXBwb3J0LnVpIGltcG9ydCBXZWJEcml2ZXJXYWl0CmZyb20gc2VsZW5pdW0ud2ViZHJpdmVyLmNvbW1vbi5ieSBpbXBvcnQgQnkKZnJvbSBzZWxlbml1bS53ZWJkcml2ZXIuc3VwcG9ydCBpbXBvcnQgZXhwZWN0ZWRfY29uZGl0aW9ucyBhcyBFQwpmcm9tIHNlbGVuaXVtX3V0aWxpdGllcyBpbXBvcnQgZ2V0Q2hyb21lRHJpdmVyCmZyb20gdWdlbnRzIGltcG9ydCBnZXRBZ2VudCBhcyBnYQpmcm9tIHJlcXVlc3RzIGltcG9ydCBnZXQKCmRlZiBnZXRBZ2VudCgpOgoJYWdlbnQgPSAnJwoJY2hhbmNlID0gcm50KDEsIDEwMCkKCWlmIGNoYW5jZSA+PSAyMDoKCQlicm93c2VyID0gJ0Nocm9tZScKCWVsaWYgY2hhbmNlIDw9IDU6CgkJYnJvd3NlciA9ICdPcGVyYScKCWVsc2U6CgkJYnJvd3NlciA9ICdGaXJlZm94JwoJd2hpbGUgJ1dpbmRvd3MnIGFuZCBicm93c2VyIG5vdCBpbiBhZ2VudDoKCQlhZ2VudCA9IGdhKCkKCXJldHVybiBhZ2VudAoKZGVmIGNoZWNrQnV0dG9uKGRyaXZlcik6Cgl0cnk6CgkJaWYgJ1ByZW1pdW0nIGluIGRyaXZlci5maW5kX2VsZW1lbnRfYnlfeHBhdGgoJy9odG1sL2JvZHkvZGl2WzJdL2RpdlsyXS9kaXZbMl0vZGl2L2Rpdi9kaXYvZGl2L2Rpdls1XS9kaXZbM10vYScpLnRleHQ6CgkJCXJldHVybiBUcnVlCglleGNlcHQ6CgkJcGFzcwoJcmV0dXJuIEZhbHNlCgpkZWYgY2xpY2tBbmRBbmFseXplKGl0ZW0pOgoJdHJ5OgoJCXNyYyA9IGRyaXZlci5wYWdlX3NvdXJjZQoJCUFjdGlvbkNoYWlucyhkcml2ZXIpLm1vdmVfdG9fZWxlbWVudChpdGVtKS5jbGljaygpLnBlcmZvcm0oKQoJCWlmIGxlbihkcml2ZXIud2luZG93X2hhbmRsZXMpID4gMToKCQkJZHJpdmVyLnN3aXRjaF90b193aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWzFdKQoJCQlkcml2ZXIuY2xvc2UoKQoJCQlkcml2ZXIuc3dpdGNoX3RvX3dpbmRvdyhkcml2ZXIud2luZG93X2hhbmRsZXNbMF0pCgkJCWlmIHNyYyA9PSBkcml2ZXIucGFnZV9zb3VyY2U6CgkJCQljbGlja0FuZEFuYWx5emUoaXRlbSkKCWV4Y2VwdDoKCQlwYXNzCgpkZWYgaW5pdCgpOgoJb3B0aW9ucyA9IHdlYmRyaXZlci5DaHJvbWVPcHRpb25zKCkKCW9wdGlvbnMuYWRkX2FyZ3VtZW50KCd1c2VyLWFnZW50PXt9Jy5mb3JtYXQoZ2V0QWdlbnQoKSkpCglvcHRpb25zLmFkZF9leHBlcmltZW50YWxfb3B0aW9uKCJleGNsdWRlU3dpdGNoZXMiLCBbImVuYWJsZS1hdXRvbWF0aW9uIl0pCglvcHRpb25zLmFkZF9leHBlcmltZW50YWxfb3B0aW9uKCd1c2VBdXRvbWF0aW9uRXh0ZW5zaW9uJywgRmFsc2UpCgoJZHJpdmVyID0gd2ViZHJpdmVyLkNocm9tZShleGVjdXRhYmxlX3BhdGg9Z2V0Q2hyb21lRHJpdmVyKCksIGNocm9tZV9vcHRpb25zPW9wdGlvbnMpCglpZiBsZW4oZHJpdmVyLndpbmRvd19oYW5kbGVzKSA+IDE6CgkJZHJpdmVyLnN3aXRjaF90b193aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWzBdKQoJCWRyaXZlci5jbG9zZSgpCgkJZHJpdmVyLnN3aXRjaF90b193aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWzBdKQoJcmV0dXJuIGRyaXZlcgoKZGVmIHNvbHZlQ2FwdGNoYShzaXRla2V5LCB1cmwpOgoJY2lkID0gZ2V0KGYnaHR0cDovL2FwaS5jYXB0Y2hhLmd1cnUvaW4ucGhwP2tleT17dG9rZW59Jm1ldGhvZD11c2VycmVjYXB0Y2hhJmdvb2dsZWtleT17c2l0ZWtleX0mcGFnZXVybD17dXJsfSZqc29uPTEnKS5qc29uKClbJ3JlcXVlc3QnXQoJc3RhdHVzID0gRmFsc2UKCXdoaWxlIG5vdCBzdGF0dXM6CgkJciA9IGdldChmJ2h0dHA6Ly9hcGkuY2FwdGNoYS5ndXJ1L3Jlcy5waHA/a2V5PXt0b2tlbn0mYWN0aW9uPWdldCZpZD17Y2lkfSZqc29uPTEnKS5qc29uKCkKCQlzdGF0dXMgPSBib29sKHJbJ3N0YXR1cyddKQoJCWN0b2tlbiA9IHJbJ3JlcXVlc3QnXQoJCWlmIG5vdCAnUkVBRFknIGluIGN0b2tlbjoKCQkJcmV0dXJuIGN0b2tlbgoJCXNsZWVwKDUpCgpsaW5rID0gJ2h0dHBzOi8vZGxzaGFyZWZpbGUuY29tL2ZpbGUvNDE5OTcxNDA1Jwp0b2tlbiA9ICczNjUwZWRhNGYwNzQxZmY1MzBjZmJjNTE1NjM2ODAyNCcKCm9sZCA9IFRydWUKCndoaWxlIG9sZDoKCWRyaXZlciA9IGluaXQoKQoJaWYgbGVuKGRyaXZlci53aW5kb3dfaGFuZGxlcykgPiAxOgoJCWRyaXZlci5zd2l0Y2hfdG9fd2luZG93KGRyaXZlci53aW5kb3dfaGFuZGxlc1swXSkKCQlkcml2ZXIuY2xvc2UoKQoJCWRyaXZlci5zd2l0Y2hfdG9fd2luZG93KGRyaXZlci53aW5kb3dfaGFuZGxlc1swXSkKCWRyaXZlci5nZXQoJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVjYXB0Y2hhL2FwaTIvZGVtbycpCgl0cnk6CgkJV2ViRHJpdmVyV2FpdChkcml2ZXIsIDEwKS51bnRpbChFQy5mcmFtZV90b19iZV9hdmFpbGFibGVfYW5kX3N3aXRjaF90b19pdCgoQnkuQ1NTX1NFTEVDVE9SLCJpZnJhbWVbbmFtZV49J2EtJ11bc3JjXj0naHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9yZWNhcHRjaGEvYXBpMi9hbmNob3I/J10iKSkpCgkJb2xkID0gRmFsc2UKCWV4Y2VwdDoKCQlkcml2ZXIucXVpdCgpCglpZiBub3Qgb2xkOgoJCWRyaXZlci5nZXQoJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL29vcHMnKQoJCWRyaXZlci5leGVjdXRlX3NjcmlwdChmJ2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dvLWNvbnRhaW5lciIpLmhyZWYgPSAie2xpbmt9IicpCgkJc2xlZXAoMSkKCgkJdHJ5OgoJCQlkcml2ZXIuZmluZF9lbGVtZW50X2J5X2lkKCdsb2dvLWNvbnRhaW5lcicpLmNsaWNrKCkKCQlleGNlcHQ6CgkJCXBhc3MKCQl3aGlsZSAneW91dHViZScgaW4gZHJpdmVyLmN1cnJlbnRfdXJsOgoJCQlzbGVlcCgxKQoKCQl0cnk6CgkJCWNsaWNrQW5kQW5hbHl6ZShkcml2ZXIuZmluZF9lbGVtZW50X2J5X3hwYXRoKCcvaHRtbC9ib2R5L2RpdlszXS9kaXYvZGl2WzJdL2Rpdi9kaXYvZGl2WzNdL2RpdlsyXS9kaXZbMl0vZGl2L2RpdlszXS9kaXYvZGl2L2RpdicpKQoKCQkJd2hpbGUgVHJ1ZToKCQkJCXRyeToKCQkJCQlkcml2ZXIuZmluZF9lbGVtZW50X2J5X3hwYXRoKCcvaHRtbC9ib2R5L2RpdlszXS9kaXYvZGl2WzJdL2Rpdi9kaXYvZGl2WzNdL2RpdlsyXS9kaXYvZGl2L2RpdlsxXS9kaXZbMl0vYS9kaXYvZGl2L2RpdlsyXS9oNScpCgkJCQkJc2xlZXAoMykKCQkJCQlicmVhawoJCQkJZXhjZXB0OgoJCQkJCXBhc3MKCgkJCWNsaWNrQW5kQW5hbHl6ZShkcml2ZXIuZmluZF9lbGVtZW50X2J5X3hwYXRoKCcvaHRtbC9ib2R5L2RpdlszXS9kaXYvZGl2WzJdL2Rpdi9kaXYvZGl2WzNdL2RpdlsyXS9kaXYvZGl2L2RpdlsxXS9kaXZbMl0vYS9kaXYvZGl2L2RpdlsyXS9oNScpKQoJCQlzbGVlcCgxNSkKCQkJY2xpY2tBbmRBbmFseXplKGRyaXZlci5maW5kX2VsZW1lbnRfYnlfeHBhdGgoJy9odG1sL2JvZHkvZGl2WzNdL2Rpdi9kaXZbMl0vZGl2L2Rpdi9kaXZbM10vZGl2WzJdL2Rpdi9kaXYvZGl2WzFdL2RpdlszXS9kaXYvZGl2L2RpdlsyXS9oNScpKQoJCQlzbGVlcCgxNSkKCQkJY2xpY2tBbmRBbmFseXplKGRyaXZlci5maW5kX2VsZW1lbnRfYnlfeHBhdGgoJy9odG1sL2JvZHkvZGl2WzNdL2Rpdi9kaXZbMl0vZGl2L2Rpdi9kaXZbM10vZGl2WzJdL2Rpdi9kaXYvZGl2WzFdL2Rpdls0XS9kaXYvZGl2L2RpdlsxXS9idXR0b24nKSkKCQkJc2xlZXAoMykKCQkJY2xpY2tBbmRBbmFseXplKGRyaXZlci5maW5kX2VsZW1lbnRfYnlfeHBhdGgoJy9odG1sL2JvZHkvZGl2WzNdL2Rpdi9kaXZbMl0vZGl2L2Rpdi9kaXZbM10vZGl2WzJdL2Rpdi9kaXYvZGl2WzFdL2Rpdls1XS9hL2Rpdi9kaXYvZGl2WzJdL2g1JykpCgkJCXNsZWVwKDE1KQoKCQkJY2xpY2tBbmRBbmFseXplKGRyaXZlci5maW5kX2VsZW1lbnRfYnlfeHBhdGgoJy9odG1sL2JvZHkvZGl2WzNdL2Rpdi9kaXZbMl0vZGl2L2Rpdi9kaXZbM10vZGl2WzJdL2Rpdi9kaXYvZGl2WzFdL2Rpdls2XScpKQoKCQkJc2xlZXAoNSkKCgkJCXNpdGVrZXkgPSBkcml2ZXIuZmluZF9lbGVtZW50X2J5X2NsYXNzX25hbWUoJ2ctcmVjYXB0Y2hhJykuZ2V0X2F0dHJpYnV0ZSgnZGF0YS1zaXRla2V5JykKCQkJZHJpdmVyLmV4ZWN1dGVfc2NyaXB0KGYnZG90TmV0T2JqZWN0Lmludm9rZU1ldGhvZEFzeW5jKFwnQ2FsbGJhY2tPblN1Y2Nlc3NBc3luY1wnLCBcJ3tzb2x2ZUNhcHRjaGEoc2l0ZWtleSwgZHJpdmVyLmN1cnJlbnRfdXJsKX1cJyk7JykKCQkJc2xlZXAoMykKCgkJCWNsaWNrQW5kQW5hbHl6ZShkcml2ZXIuZmluZF9lbGVtZW50X2J5X3hwYXRoKCcvaHRtbC9ib2R5L2RpdlszXS9kaXYvZGl2WzJdL2Rpdi9kaXYvZGl2WzNdL2RpdlsyXS9kaXYvZGl2L2RpdlsyXS9kaXZbMl0nKSkKCQkJc2xlZXAoNSkKCgkJCXdoaWxlICcuY3Jkb3dubG9hZCcgaW4gbGlzdGRpcignQzpcXFVzZXJzXFxydW5uZXJhZG1pblxcRG93bmxvYWRzJyk6CgkJCQlzbGVlcCg1KQoJCWV4Y2VwdDoKCQkJZHJpdmVyLnF1aXQoKQoJCQlvbGQgPSBUcnVlCgpwb3N0KGYnaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zZXJ2ZXJob2pvL2Nsb3VkX2RhdGEvYWN0aW9ucy93b3JrZmxvd3MvMjM5MzQ4NDQvZGlzcGF0Y2hlcycsIGhlYWRlcnM9eydBdXRob3JpemF0aW9uJzogZid0b2tlbiBnaHBfZGhDWWV0M29sc3MwM2FjVHh5dWRqaWpSeXA4M1VTNE9VS3Y5J30sIGpzb249eydyZWYnOiAnbWFpbid9KQpleGl0KCk=').decode('utf-8'))